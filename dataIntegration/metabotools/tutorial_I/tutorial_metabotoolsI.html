<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Metabotools tutorial I</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S6 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S8 { line-height: 15.5926675796509px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S10 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S11 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S13 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S14 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S15 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S16 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S17 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S18 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Metabotools tutorial I</span></h1><h2 class = "S3"><span class = "S2">Authors: Maike K. Aurich, Sylvain Arreckx, </span><span class = "S2">Systems Biochemistry Group, LCSB, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer(s): Anne Richelle, Lewis Lab at University of California, San Diego.</span></h2><p class = "S4"><span class = "S5">INTRODUCTION</span></p><p class = "S4"><span class = "S2">In this tutorial, we generate contextualized models of two lymphoblastic leukemia cell lines, CCRF-CEM and Molt- 4 cells. They will be generated by integrating semi-quantitative metabolomic data, transcriptomic data, and growth rates. We will afterwards analyze the solution space of these models by using a sampling analysis.</span></p><p class = "S4"><span class = "S2">Before running a section in the tutorial, read the corresponding sections in the MetaboTools protocol and supplemental tutorial (Data sheet 2,</span><span class = "S2"> </span><a href = 'http://journal.frontiersin.org/article/10.3389/fphys.2016.00327/full'><span class = "S0">http://journal.frontiersin.org/article/10.3389/fphys.2016.00327/full</span></a><span class = "S2">). </span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S5">PROCEDURE</span></p><p class = "S4"><span class = "S2">Clear workspace and initialize the COBRA Toolbox</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">clear</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">initCobraToolbox</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> </span><span class = "S2">0</span><span class = "S2"> - Define the output location and set the LP solver</span></h2><p class = "S4"><span class = "S2">Define the output path and set the solver for LP problem</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">global </span><span class = "S12">CBTDIR </span><span class = "S13">% set path to cobratoolbox (pathToCOBRA)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">outputPath = pwd;</span><span class = "S13">% ouputPath = 'ADD YOUR PATH TO YOUR OUTPUT FOLDER'</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">solver = </span><span class = "S14">'glpk'</span><span class = "S12">; </span><span class = "S13">% solver = 'ADD YOUR SOLVER'; %, e.g., 'cplex_direct' for ILOG</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">solverOK = changeCobraSolver(solver, </span><span class = "S14">'LP'</span><span class = "S9">);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Check the solver setup</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S9">solverOK == 1</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    fprintf(</span><span class = "S14">'Solver %s is set.\n'</span><span class = "S9">, solver);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    error(</span><span class = "S14">'Solver %s could not be used. Check if %s is in the matlab path (set path) or check for typos'</span><span class = "S9">, solver, solver);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Load and check that the input model is correclty loaded</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">tutorialPath = [CBTDIR filesep </span><span class = "S14">'tutorials' </span><span class = "S12">filesep </span><span class = "S14">'metabotools' </span><span class = "S12">filesep </span><span class = "S14">'tutorial_I'</span><span class = "S9">];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S12">isequal(exist([tutorialPath filesep </span><span class = "S14">'starting_model.mat'</span><span class = "S12">], </span><span class = "S14">'file'</span><span class = "S9">), 2)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    load([tutorialPath filesep </span><span class = "S14">'starting_model.mat'</span><span class = "S9">]);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    fprintf(</span><span class = "S14">'The model is loaded.\n'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    error(</span><span class = "S14">'The model ''starting_model'' could not be loaded.'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Check output path and writing permission</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S12">~exist(outputPath, </span><span class = "S14">'dir'</span><span class = "S9">) == 7</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    error(</span><span class = "S14">'Output directory in ''outputPath'' does not exist. Verify that you type it correctly or create the directory.'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">% Make and save a dummy file to test the writing to output directory</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">A</span><span class = "S9"> = rand(1);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">try</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    save([outputPath filesep </span><span class = "S14">'A'</span><span class = "S9">]);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">catch </span><span class = "S9">ME</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    error(</span><span class = "S14">'Files cannot be saved to the provided location: %s\nObtain rights to write into %s directory or set ''outputPath'' to a different directory.'</span><span class = "S9">, outputPath, outputPath);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step 1: Shaping the model's environment using setMediumConstraints</span></h2><p class = "S4"><span class = "S2">Constrain the model using the data related to RPMI medium composition. To this end, define the set of exchange reactions for which exometabolomic data are available</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">medium_composition = {</span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_arg_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_asn_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_asp_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_glu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gly(e)'</span><span class = "S12">;</span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ile_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_leu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_met_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_phe_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4HPRO(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pro_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ser_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_thr_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_trp_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_tyr_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_val_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ascb_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_btn(e)'</span><span class = "S12">;</span><span class = "S14">'EX_chol(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pnto_R(e)'</span><span class = "S12">;</span><span class = "S14">'EX_fol(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ncam(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_pydxn(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ribflv(e)'</span><span class = "S12">;</span><span class = "S14">'EX_thm(e)'</span><span class = "S12">;</span><span class = "S14">'EX_inost(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ca2(e)'</span><span class = "S12">;</span><span class = "S14">'EX_fe3(e)'</span><span class = "S12">;</span><span class = "S14">'EX_k(e)'</span><span class = "S12">;</span><span class = "S14">'EX_hco3(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_na1(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pi(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glc(e)'</span><span class = "S12">;</span><span class = "S14">'EX_hxan(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lnlc(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lipoate(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pyr(e)'</span><span class = "S12">;</span><span class = "S14">'EX_thymd(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_gthrd(e)'</span><span class = "S12">;</span><span class = "S14">'EX_anth(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">% Medium concentrations</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">met_Conc_mM = [0.1;1.15;0.15;0.379;0.208;2;0.136;0.133;0.0968;0.382;0.382;0.274;0.101;0.0909;0.153;0.174;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    0.286;0.168;0.0245;0.129;0.171;0.00863;0.00082;0.0214;0.000524;0.00227;0.082;0.00485;0.000532;0.00297;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    0.194;0.424;0;5.33;23.81;127.26;5.63;11.11;0;0;0;1;0;0.00326;0.0073];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Define constraints on basic medium components (i.e., metabolites that are uptake from the medium but not captured by the measured data) </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">mediumCompounds = {</span><span class = "S14">'EX_co2(e)'</span><span class = "S12">;</span><span class = "S14">'EX_h(e)'</span><span class = "S12">;</span><span class = "S14">'EX_h2o(e)'</span><span class = "S12">;</span><span class = "S14">'EX_hco3(e)'</span><span class = "S12">;</span><span class = "S14">'EX_nh4(e)'</span><span class = "S12">;</span><span class = "S14">'EX_o2(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pi(e)'</span><span class = "S12">;</span><span class = "S14">'EX_so4(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">mediumCompounds_lb = -100;</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Define also additional constraints to limit the model behaviour (e.g., secretion of oxygen, essential amino acids that need to be taken up)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">customizedConstraints = {</span><span class = "S14">'EX_o2(e)'</span><span class = "S12">;</span><span class = "S14">'EX_strch1(e)'</span><span class = "S12">;</span><span class = "S14">'EX_acetone(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glc(e)'</span><span class = "S12">;</span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_val_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_met_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">customizedConstraints_lb = [-2.3460;0;0;-500;-100;-100;-100];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">customizedConstraints_ub = [500;0;0;500;500;500;500];</span></p></div></div><p class = "S17"><span class = "S2">Apply the medium constraints previously defined using </span><span class = "S18">setMediumConstraints. </span><span class = "S2">Note that this function also require the definition of the cell concentration (</span><span class = "S18">cellConc</span><span class = "S2">), the cell weight (</span><span class = "S18">cellWeight</span><span class = "S2">), the time (</span><span class = "S18">t</span><span class = "S2">), the current value and the new value for infinite constraints (respectively </span><span class = "S18">current_inf</span><span class = "S2"> and </span><span class = "S18">set_inf</span><span class = "S2">).</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">cellConc = 2.17 * 1e6;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">cellWeight = 3.645e-12;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">t = 48;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">current_inf = 1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">set_inf = 500;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[modelMedium, ~] = setMediumConstraints(starting_model, set_inf, current_inf, medium_composition, met_Conc_mM, cellConc, </span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    t, cellWeight, mediumCompounds, mediumCompounds_lb, customizedConstraints, customizedConstraints_ub, customizedConstraints_lb);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> </span><span class = "S2">2</span><span class = "S2">: calculate the limit of detection (LODs) for each metabolites</span></h2><p class = "S4"><span class = "S2">Use the function </span><span class = "S18">calculateLODs</span><span class = "S2"> to converts detection limits of unit </span><span class = "S18">ng/mL</span><span class = "S2"> to </span><span class = "S18">mM</span><span class = "S2"> using the theoretical mass (g/mol)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">ex_RXNS = {</span><span class = "S14">'EX_5mta(e)'</span><span class = "S12">;</span><span class = "S14">'EX_uri(e)'</span><span class = "S12">;</span><span class = "S14">'EX_chol(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ncam(e)'</span><span class = "S12">;</span><span class = "S14">'EX_3mop(e)'</span><span class = "S12">;</span><span class = "S14">'EX_succ(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pnto_R(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_5oxpro(e)'</span><span class = "S12">;</span><span class = "S14">'EX_thm(e)'</span><span class = "S12">;</span><span class = "S14">'EX_anth(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4HPRO(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lac_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_3mob(e)'</span><span class = "S12">;</span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_trp_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_orn(e)'</span><span class = "S12">;</span><span class = "S14">'EX_arg_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_thr_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_fol(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4pyrdx(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_ser_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glc(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ribflv(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_tyr_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_phe_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_inost(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_Lcystin(e)'</span><span class = "S12">;</span><span class = "S14">'EX_leu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_met_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_asn_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_mal_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ile_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_pyr(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cit(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pro_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gly(e)'</span><span class = "S12">;</span><span class = "S14">'EX_asp_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_34hpp'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_octa(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4mop(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glyb(e)'</span><span class = "S12">;</span><span class = "S14">'EX_val_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ade(e)'</span><span class = "S12">;</span><span class = "S14">'EX_hxan(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gua(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ins(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_orot(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ura(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ahcys(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cbasp(e)'</span><span class = "S12">;</span><span class = "S14">'EX_Lcystin(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ser_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_thm(e)'</span><span class = "S12">;</span><span class = "S14">'EX_arg_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ncam(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">theo_mass = [298.0974;243.0617;104.1075;123.0558;129.0552;117.0188;220.1185;128.0348;265.1123;138.0555;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    132.0661;89.0239;115.0395;156.0773;205.0977;133.0977;175.1195;120.0661;440.1319;147.077;182.0453;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    106.0504;179.0556;377.1461;148.061;182.0817;166.0868;179.0556;241.0317;132.1025;150.0589;122.0276;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    133.0613;133.0137;132.1025;87.0082;147.1134;90.0555;191.0192;116.0712;74.0242;134.0453;180.157;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    172.265;130.142;118.0868;118.0868;136.0623;137.0463;152.0572;267.0729;155.0093;111.0195;385.1294;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    175.0355;241.0317;106.0504;122.0276;265.1123;175.1195;123.0558];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">lod_ngmL = [0.3;1.7;2.8;3;3.5;3.9;4;4.8;6.1;7.7;8.1;10.9;11.2;13.6;15.7;16.9;24.8;25.6;25.7;28.4;32.7;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    37.5;44;45;45;47.4;48.4;59;59.7;68.9;74.1;77;82.1;99.2;112.9;121.3;131.7;133.5;150.8;169.2;214.3;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    229.5;537.3;10.9;3.5;2.8;28.2;1.6;0.8;48.9;8.8;37.1;52.4;50;229.5;59.7;37.5;77;6.1;24.8;3];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[lod_mM] = calculateLODs(theo_mass, lod_ngmL);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> </span><span class = "S2">3:</span><span class = "S2"> define the uptake and secretion profiles</span></h2><p class = "S4"><span class = "S2">Exclude metabolites with uncertain experimental data from the list of metabolites for which uptake and secretion profiles need to be computed</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">exclude_upt = {</span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_mal_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_fol(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">exclude_secr = {</span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_ala_L(e)'</span><span class = "S9">};</span></p></div></div><p class = "S17"><span class = "S2">Define metabolites with missing experimental points but for which uptake and secretion profiles need to be computed</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">add_secr = {</span><span class = "S14">'EX_mal_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">add_upt = {};</span></p></div></div><p class = "S17"><span class = "S2">The essential amino acids should be excluded from the secretion profile</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">essAA_excl = {</span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_ile_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_leu_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_lys_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_met_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_phe_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_thr_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_trp_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_val_L(e)'</span><span class = "S9">};</span></p></div></div><p class = "S17"><span class = "S2">Define the list of metabolites for which experimental data are available</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">data_RXNS = {</span><span class = "S14">'EX_orn(e)'</span><span class = "S12">;</span><span class = "S14">'EX_mal_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lac_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_gly(e)'</span><span class = "S12">;</span><span class = "S14">'EX_glu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cit(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_5oxpro(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4mop(e)'</span><span class = "S12">;</span><span class = "S14">'EX_3mop(e)'</span><span class = "S12">;</span><span class = "S14">'EX_3mob(e)'</span><span class = "S12">;</span><span class = "S14">'EX_tyr_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_trp_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_thr_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pyr(e)'</span><span class = "S12">;</span><span class = "S14">'EX_phe_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_lys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_leu_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ile_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_glc(e)'</span><span class = "S12">;</span><span class = "S14">'EX_chol(e)'</span><span class = "S12">;</span><span class = "S14">'EX_anth(e)'</span><span class = "S12">;</span><span class = "S14">'EX_val_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_met_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_cys_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pi(e)'</span><span class = "S12">;</span><span class = "S14">'EX_asp_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_4HPRO(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_pnto_R(e)'</span><span class = "S12">;</span><span class = "S14">'EX_pro_L(e)'</span><span class = "S12">;</span><span class = "S14">'EX_fol(e)'</span><span class = "S9">};</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Define the data associated with Molt-4 cell cultures</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">input_A = [</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S13">% control TP 1	control TP 2	Cond TP 1	Cond TP 2</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    65245.09667	68680.93	54272.41667	65159.50333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	30970.784	20292.406	27226.6555</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2038946.433	1917042.967	5654513.467	101768253</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    163882.9467	186682.92	121762.3567	310547.7</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    473539.8667	455197.4667	462903.8333	1024508.5</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    8681.527333	8704.7345	9459.837	34177.945</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    29168.15	21808.73	120655.9867	2060525.467</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	34436.50433	113668.5123</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	25108.829	121927.3673</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	3000	14717.55667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    4142302	4063607.667	3934639.333	3075783.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2153692	2132723.667	2037735.333	1387754.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    406102.2667	417512.6333	381085.2333	259555.2667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    465074.6	387569.1333	439148.0667	210407.8333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    8087955	8345511.333	8215168.333	5360276</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    198435.8	195675.8	188473.1	112386.1667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    20823770.33	20801258.67	19725086.67	15148808</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    21229254.67	21225778.33	20799761	17160163</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    76555640.67	71459886.33	61697085.33	34981419.33</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    876300.4333	905132.5	892182.2	541860.4667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    159124.46	178538.2167	162567.13	3000</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2857012.667	2900419.667	2853523.667	1793173.667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2995910.333	3018536.333	3024630.333	2266832.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    69077.16333	67843.12	69406.69	95624.28</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	824549.3667	2283200.867</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    45304.84667	52977.77333	56566.27667	60759.23</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    1613345.1	1258710.1	3430342.067	25970024.1</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    216828142.3	221118425	223518663	216863897.3</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    632160.0333	612562.3	590881.7333	940705.6</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    814465.8333	786011.5667	630513.4	622493.9</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    84638.70667	86751.96	89717.10667	68882.68333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    5107317.333	5168599.333	5163708.333	5263614.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    95419.73667	105904.7067	97550.78667	102678.49</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">];</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Define the data associated with CCRF-CEM cell cultures</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">input_B = [</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S13">% control 2 TP 1	control 2 TP 2	Cond 2 TP 1	Cond 2 TP 2</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    65245.09667	68680.93	73850.77	98489.89</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	30970.784	3000	94181.77233</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2038946.433	1917042.967	5222377.933	134980059.9</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    163882.9467	186682.92	219683.7	460476.5267</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    473539.8667	455197.4667	437398.3667	630407.2667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    8681.527333	8704.7345	8317.144	86546.77933</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    29168.15	21808.73	62146.47333	1012932.38</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	9918.992	129433.4973</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	7222.259333	145547.7347</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	3000	17641.55667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    4142302	4063607.667	4023284.333	3489981.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2153692	2132723.667	2068977	1570648</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    406102.2667	417512.6333	386495.2	303808.2</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    465074.6	387569.1333	376779.1	249036.3333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    8087955	8345511.333	8237784.667	6540301.667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    198435.8	195675.8	196447.1	149861.6667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    20823770.33	20801258.67	21119935.67	16346765.67</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    21229254.67	21225778.33	20790535.33	17219085</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    76555640.67	71459886.33	65009057.67	24330565.33</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    876300.4333	905132.5	884112.5667	259273.9333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    159124.46	178538.2167	158271.14	60631.19333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2857012.667	2900419.667	2668140	2790196.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    2995910.333	3018536.333	2890029.333	2538211</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    69077.16333	67843.12	74035.24	86165.55</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    3000	3000	323185.6667	2063962.067</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    45304.84667	52977.77333	62076.23333	64524.22333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    1613345.1	1258710.1	2788313.567	30868376.53</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    216828142.3	221118425	212276379	208623151.3</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    632160.0333	612562.3	680373.4333	770903.9333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    814465.8333	786011.5667	679862.7	582257.4667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    84638.70667	86751.96	88002.12	99449.36667</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    5107317.333	5168599.333	5134219	4445918.333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    95419.73667	105904.7067	100629.24	84807.62333</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">];</span></p></div></div><p class = "S17"><span class = "S2">Use the function </span><span class = "S18">defineUptakeSecretionProfiles</span><span class = "S2"> to calculate the uptake and secretion rate over the time of the culture for both condition (e.g. CCRF-CEM and Molt- 4 cells)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">tol = 0.05;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion, slope_Ratio] = defineUptakeSecretionProfiles</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    (input_A, input_B, data_RXNS, tol, essAA_excl, exclude_upt, exclude_secr, add_secr, add_upt);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> </span><span class = "S2">4</span><span class = "S2">: Calculate the difference between the uptake and secretion profiles from the two conditions</span></h2><p class = "S4"><span class = "S2">Use </span><span class = "S18">calculateQuantitativeDiffs </span><span class = "S2">to calculate the sets of exchange reactions with higher uptake and secretion in condition 1 than in condition 2.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher, cond1_uptake_LODs,</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    cond2_uptake_LODs, cond1_secretion_LODs, cond2_secretion_LODs] = calculateQuantitativeDiffs(data_RXNS,</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    slope_Ratio, ex_RXNS, lod_mM, cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">NOTE: Sometimes, you will need to remove some metabolites from the uptake and secretion profiles, e.g. those for which you assume a different directionality as in the data or if the metabolites is not detected at a specific sampling time. Indeed, the inclusion of these extreme point could distort the results. Example of consumption slope ratio associated to </span><span class = "S18">EX_anth(e)</span><span class = "S2"> is 1975% higher in Molt-4 compared to CCRF-CEM cells. Therefore, these metabolites need to be removed from the input for semi-quantitative adjustment unless such large differences are justified and make sense biologically.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">remove = {</span><span class = "S14">'EX_anth(e)'</span><span class = "S12">; </span><span class = "S14">'EX_ile_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">A = [];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S9">i = 1:length(cond2_upt_higher)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S11">if </span><span class = "S9">find(ismember(remove, cond2_upt_higher{i, 1})) &gt; 0</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">        </span><span class = "S12">A</span><span class = "S9"> = [A; i];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">cond2_upt_higher(A, :) = [];</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> </span><span class = "S2">5</span><span class = "S2">:  Enforce uptake and secretion rate using qualitative constraints</span></h2><p class = "S4"><span class = "S2">Use the function </span><span class = "S18">setQualitativeConstraints</span><span class = "S2"> to enforce minimal uptake or secretion based on individual detection limits (e.g., based on the uptake and secretion profile of metabolites measured through mass-spectrometry). If these values are not available, a very small value (e.g., 1.0E-06) can be used. Note that this value has to be below the concentrations defined in the medium, otherwise the model will be infeasible.</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Definition of the qualitative constraints for Molt-4 cells</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">ambiguous_metabolites = {</span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cys_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">basisMedium = {</span><span class = "S14">'EX_o2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_strch1(e)'</span><span class = "S12">; </span><span class = "S14">'EX_acetone(e)'</span><span class = "S12">; </span><span class = "S14">'EX_glc(e)'</span><span class = "S12">; </span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_ca2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cl(e)'</span><span class = "S12">; </span><span class = "S14">'EX_co(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_fe2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_fe3(e)'</span><span class = "S12">; </span><span class = "S14">'EX_k(e)'</span><span class = "S12">; </span><span class = "S14">'EX_na1(e)'</span><span class = "S12">; </span><span class = "S14">'EX_i(e)'</span><span class = "S12">; </span><span class = "S14">'EX_sel(e)'</span><span class = "S12">; </span><span class = "S14">'EX_co2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_h(e)'</span><span class = "S12">; </span><span class = "S14">'EX_h2o(e)'</span><span class = "S12">; </span><span class = "S14">'EX_hco3(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_nh4(e)'</span><span class = "S12">; </span><span class = "S14">'EX_o2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_pi(e)'</span><span class = "S12">; </span><span class = "S14">'EX_so4(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[model_A] = setQualitativeConstraints(modelMedium, cond1_uptake, cond1_uptake_LODs, cond1_secretion, cond1_secretion_LODs, </span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    cellConc, t, cellWeight, ambiguous_metabolites, basisMedium);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Definition of the qualitative constraints for CCRF-CEM cells</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">ambiguous_metabolites = {</span><span class = "S14">'EX_ala_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_gln_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_pydxn(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cys_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">basisMedium = {</span><span class = "S14">'EX_ca2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_cl(e)'</span><span class = "S12">; </span><span class = "S14">'EX_co(e)'</span><span class = "S12">; </span><span class = "S14">'EX_fe2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_fe3(e)'</span><span class = "S12">; </span><span class = "S14">'EX_k(e)'</span><span class = "S12">; </span><span class = "S14">'EX_na1(e)'</span><span class = "S12">; </span><span class = "S14">'EX_i(e)'</span><span class = "S12">; </span><span class = "S14">'EX_sel(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_co2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_h(e)'</span><span class = "S12">; </span><span class = "S14">'EX_h2o(e)'</span><span class = "S12">; </span><span class = "S14">'EX_hco3(e)'</span><span class = "S12">; </span><span class = "S14">'EX_nh4(e)'</span><span class = "S12">; </span><span class = "S14">'EX_o2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_pi(e)'</span><span class = "S12">; </span><span class = "S14">'EX_so4(e)'</span><span class = "S12">; </span><span class = "S14">'EX_his_L(e)'</span><span class = "S12">;</span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">    </span><span class = "S14">'EX_o2(e)'</span><span class = "S12">; </span><span class = "S14">'EX_strch1(e)'</span><span class = "S12">; </span><span class = "S14">'EX_acetone(e)'</span><span class = "S12">; </span><span class = "S14">'EX_glc(e)'</span><span class = "S12">; </span><span class = "S14">'EX_val_L(e)'</span><span class = "S12">; </span><span class = "S14">'EX_met_L(e)'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[model_B] = setQualitativeConstraints(modelMedium, cond2_uptake, cond2_uptake_LODs, cond2_secretion, cond2_secretion_LODs, </span><span class = "S15">...</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    cellConc, t, cellWeight, ambiguous_metabolites, basisMedium);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> 6: Define semi quantitative constraints</span></h2><p class = "S4"><span class = "S2">Use the relative difference of signal intensities previously calculated for the two conditions (</span><span class = "S18">calculateQuantitativeDiffs</span><span class = "S2">) to define semi-quantitative constraints (setSemiQuantConstraints).</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[modelA_QUANT, modelB_QUANT] = setSemiQuantConstraints(model_A, model_B, cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> 7: Define growth constraints</span></h2><p class = "S4"><span class = "S2">Using the data related to the doubling time for each cell, constrain the growth reaction using </span><span class = "S18">setConstraintsOnBiomassReaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">GrowthRxn = </span><span class = "S14">'biomass_reaction2'</span><span class = "S9">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">tolerance = 20;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">doublingTimeA = 19.6; </span><span class = "S13">%MOLT4 cells</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[model_A_BM] = setConstraintsOnBiomassReaction(modelA_QUANT, GrowthRxn, doublingTimeA, tolerance);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">doublingTimeB = 22; </span><span class = "S13">%CCRF-CEM</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[model_B_BM] = setConstraintsOnBiomassReaction(modelB_QUANT, GrowthRxn, doublingTimeB, tolerance);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> 8: Delete absent genes</span></h2><p class = "S4"><span class = "S2">Constrain to zero the set of absent genes, defined in </span><span class = "S18">DataGenes</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">dataGenes = [535;1548;2591;3037;4248;4709;6522;7167;7367;8399;23545;129807;221823]; </span><span class = "S13">% set of genes absent in MOLT4 cells</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[model_A_GE] = integrateGeneExpressionData(model_A_BM, dataGenes);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">dataGenes = [239;443;535;1548;2683;3037;4248;4709;5232;6522;7364;7367;8399;23545;54363;66002;129807;221823];</span><span class = "S13">% set of genes absent in CCRF-CEM cells</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">[model_B_GE] = integrateGeneExpressionData(model_B_BM, dataGenes);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Step</span><span class = "S2"> 9: Extract a condition specific FVA</span></h2><p class = "S4"><span class = "S2">Use extractConditionSpecificModel to prune the model based on a user-defined flux value threshold. This function a flux variability analyis to extract a subnetwork for which all reactions carry fluxes higher or equal to the defined threshold value</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">theshold = 1e-6;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">model = model_A_GE;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[model_Molt] = extractConditionSpecificModel(model, theshold);</span><span class = "S13">%  MOLT4 condition specific model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[model_CEM] = extractConditionSpecificModel(model_B_GE, theshold);</span><span class = "S13">%  CCRF-CEM condition specific model</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S5">ANTICIPATED RESULTS</span></p><p class = "S4"><span class = "S2">Compare the differents model generated previously by analysing the metabolite connectivity of the networks</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[MetConn, RxnLength] = networkTopology(modelMedium); </span><span class = "S13">% model constrained by medium composition data</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[MetConnA, RxnLengthA] = networkTopology(model_Molt); </span><span class = "S13">%  MOLT4 condition specific model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[MetConnB, RxnLengthB] = networkTopology(model_CEM); </span><span class = "S13">%  CCRF-CEM condition specific model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">MetConnCompare = sort(MetConn, </span><span class = "S14">'descend'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">MetConnCompareA = sort(MetConnA, </span><span class = "S14">'descend'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">MetConnCompareB = sort(MetConnB, </span><span class = "S14">'descend'</span><span class = "S9">);</span></p></div></div><p class = "S17"><span class = "S2">Plot metabolite connectivity</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">figure</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">semilogy(sort(MetConnCompare, </span><span class = "S14">'descend'</span><span class = "S12">), </span><span class = "S14">'ro'</span><span class = "S9">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">hold</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">semilogy(sort(MetConnCompareA, </span><span class = "S14">'descend'</span><span class = "S12">), </span><span class = "S14">'bo'</span><span class = "S9">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">semilogy(sort(MetConnCompareB, </span><span class = "S14">'descend'</span><span class = "S12">), </span><span class = "S14">'go'</span><span class = "S9">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">title(</span><span class = "S14">'Metabolite connectivity'</span><span class = "S9">)</span></p></div></div><p class = "S17"><span class = "S2">The models can also be compared by performing a sampling analysis using </span><span class = "S18">performSampling</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">fprintf(</span><span class = "S14">'Perform sampling analysis\n'</span><span class = "S9">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">warmupn = 2000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">nFiles = 10;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">pointsPerFile = 1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">stepsPerPoint = 500;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fileBaseNo = 0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">maxTime = 3600000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9"></span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">fileName = </span><span class = "S14">'modelA'</span><span class = "S12">;</span><span class = "S13">%  MOLT4 condition specific model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">performSampling(model_Molt, warmupn, fileName, nFiles, pointsPerFile, stepsPerPoint, fileBaseNo, maxTime, outputPath);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">fileName = </span><span class = "S14">'modelB'</span><span class = "S12">;</span><span class = "S13">%  CCRF-CEM condition specific model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">performSampling(model_CEM, warmupn, fileName, nFiles, pointsPerFile, stepsPerPoint, fileBaseNo, maxTime, outputPath);</span></p></div></div><p class = "S17"><span class = "S2">Use the function </span><span class = "S18">summarizeSamplingResults</span><span class = "S2"> to return the median of the flux values from the two sampled models. The analysis can be limited to a specific set of reaction defined in </span><span class = "S18">show_rxns</span><span class = "S2">. Moreover, reactions associated with genes of special interest ( e.g. differentially expressed genes) can be defined in </span><span class = "S18">dataGenes</span><span class = "S2"> to facilitate the analysis</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fonts = 8;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">nFiles = 10;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">pointsPerFile = 1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">starting_Model = modelMedium;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">hist_per_page = 4;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">bin = 30;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">modelA = model_Molt;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">modelB = model_CEM;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">dataGenes = [32;205;411;412;1537;1608;1632;1645;1737;1757;2108;2184;2224;2539];</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">show_rxns = {</span><span class = "S14">'PYK'</span><span class = "S12">;</span><span class = "S14">'SUCD1m'</span><span class = "S12">;</span><span class = "S14">'ATPS4m'</span><span class = "S12">;</span><span class = "S14">'ETF'</span><span class = "S9">};</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S12">[stats, statsR] = summarizeSamplingResults(modelA, modelB, outputPath, nFiles, pointsPerFile, starting_Model, dataGenes, show_rxns, fonts, hist_per_page, bin, </span><span class = "S14">'modelA'</span><span class = "S12">, </span><span class = "S14">'modelB'</span><span class = "S9">);</span></p></div></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Metabotools tutorial I
%% Authors: Maike K. Aurich, Sylvain Arreckx, *Systems Biochemistry Group, LCSB, University of Luxembourg.*
%% *Reviewer(s): Anne Richelle, Lewis Lab at University of California, San Diego.*
% *INTRODUCTION*
% 
% In this tutorial, we generate contextualized models of two lymphoblastic 
% leukemia cell lines, CCRF-CEM and Molt- 4 cells. They will be generated by integrating 
% semi-quantitative metabolomic data, transcriptomic data, and growth rates. We 
% will afterwards analyze the solution space of these models by using a sampling 
% analysis.
% 
% Before running a section in the tutorial, read the corresponding sections 
% in the MetaboTools protocol and supplemental tutorial (Data sheet 2, <http://journal.frontiersin.org/article/10.3389/fphys.2016.00327/full 
% http://journal.frontiersin.org/article/10.3389/fphys.2016.00327/full>). 
% 
% *PROCEDURE*
% 
% Clear workspace and initialize the COBRA Toolbox

clear
initCobraToolbox
%% Step *0* - Define the output location and set the LP solver
% Define the output path and set the solver for LP problem

global CBTDIR % set path to cobratoolbox (pathToCOBRA)
outputPath = pwd;% ouputPath = 'ADD YOUR PATH TO YOUR OUTPUT FOLDER'
solver = 'glpk'; % solver = 'ADD YOUR SOLVER'; %, e.g., 'cplex_direct' for ILOG
solverOK = changeCobraSolver(solver, 'LP');
%% 
% Check the solver setup

if solverOK == 1
    fprintf('Solver %s is set.\n', solver);
else
    error('Solver %s could not be used. Check if %s is in the matlab path (set path) or check for typos', solver, solver);
end
%% 
% Load and check that the input model is correclty loaded

tutorialPath = [CBTDIR filesep 'tutorials' filesep 'metabotools' filesep 'tutorial_I'];
if isequal(exist([tutorialPath filesep 'starting_model.mat'], 'file'), 2)
    load([tutorialPath filesep 'starting_model.mat']);
    fprintf('The model is loaded.\n');
else
    error('The model ''starting_model'' could not be loaded.');
end
%% 
% Check output path and writing permission

if ~exist(outputPath, 'dir') == 7
    error('Output directory in ''outputPath'' does not exist. Verify that you type it correctly or create the directory.');
end

% Make and save a dummy file to test the writing to output directory
A = rand(1);
try
    save([outputPath filesep 'A']);
catch ME
    error('Files cannot be saved to the provided location: %s\nObtain rights to write into %s directory or set ''outputPath'' to a different directory.', outputPath, outputPath);
end
%% Step 1: Shaping the model's environment using setMediumConstraints
% Constrain the model using the data related to RPMI medium composition. To 
% this end, define the set of exchange reactions for which exometabolomic data 
% are available

medium_composition = {'EX_ala_L(e)';'EX_arg_L(e)';'EX_asn_L(e)';'EX_asp_L(e)';'EX_cys_L(e)';'EX_gln_L(e)';...
    'EX_glu_L(e)';'EX_gly(e)';'EX_his_L(e)';'EX_ile_L(e)';'EX_leu_L(e)';'EX_lys_L(e)';'EX_met_L(e)';...
    'EX_phe_L(e)';'EX_4HPRO(e)';'EX_pro_L(e)';'EX_ser_L(e)';'EX_thr_L(e)';'EX_trp_L(e)';'EX_tyr_L(e)';...
    'EX_val_L(e)';'EX_ascb_L(e)';'EX_btn(e)';'EX_chol(e)';'EX_pnto_R(e)';'EX_fol(e)';'EX_ncam(e)';...
    'EX_pydxn(e)';'EX_ribflv(e)';'EX_thm(e)';'EX_inost(e)';'EX_ca2(e)';'EX_fe3(e)';'EX_k(e)';'EX_hco3(e)';...
    'EX_na1(e)';'EX_pi(e)';'EX_glc(e)';'EX_hxan(e)';'EX_lnlc(e)';'EX_lipoate(e)';'EX_pyr(e)';'EX_thymd(e)';...
    'EX_gthrd(e)';'EX_anth(e)'};

% Medium concentrations
met_Conc_mM = [0.1;1.15;0.15;0.379;0.208;2;0.136;0.133;0.0968;0.382;0.382;0.274;0.101;0.0909;0.153;0.174;...
    0.286;0.168;0.0245;0.129;0.171;0.00863;0.00082;0.0214;0.000524;0.00227;0.082;0.00485;0.000532;0.00297;...
    0.194;0.424;0;5.33;23.81;127.26;5.63;11.11;0;0;0;1;0;0.00326;0.0073];

%% 
% Define constraints on basic medium components (i.e., metabolites that 
% are uptake from the medium but not captured by the measured data) 

mediumCompounds = {'EX_co2(e)';'EX_h(e)';'EX_h2o(e)';'EX_hco3(e)';'EX_nh4(e)';'EX_o2(e)';'EX_pi(e)';'EX_so4(e)'};
mediumCompounds_lb = -100;
%% 
% Define also additional constraints to limit the model behaviour (e.g., 
% secretion of oxygen, essential amino acids that need to be taken up)

customizedConstraints = {'EX_o2(e)';'EX_strch1(e)';'EX_acetone(e)';'EX_glc(e)';'EX_his_L(e)';'EX_val_L(e)';'EX_met_L(e)'};
customizedConstraints_lb = [-2.3460;0;0;-500;-100;-100;-100];
customizedConstraints_ub = [500;0;0;500;500;500;500];
%% 
% Apply the medium constraints previously defined using _setMediumConstraints. 
% _Note that this function also require the definition of the cell concentration 
% (_cellConc_), the cell weight (_cellWeight_), the time (_t_), the current value 
% and the new value for infinite constraints (respectively _current_inf_ and _set_inf_).

cellConc = 2.17 * 1e6;
cellWeight = 3.645e-12;
t = 48;
current_inf = 1000;
set_inf = 500;
[modelMedium, ~] = setMediumConstraints(starting_model, set_inf, current_inf, medium_composition, met_Conc_mM, cellConc, ...
    t, cellWeight, mediumCompounds, mediumCompounds_lb, customizedConstraints, customizedConstraints_ub, customizedConstraints_lb);
%% Step *2*: calculate the limit of detection (LODs) for each metabolites
% Use the function _calculateLODs_ to converts detection limits of unit _ng/mL_ 
% to _mM_ using the theoretical mass (g/mol)

ex_RXNS = {'EX_5mta(e)';'EX_uri(e)';'EX_chol(e)';'EX_ncam(e)';'EX_3mop(e)';'EX_succ(e)';'EX_pnto_R(e)';...
    'EX_5oxpro(e)';'EX_thm(e)';'EX_anth(e)';'EX_4HPRO(e)';'EX_lac_L(e)';'EX_3mob(e)';'EX_his_L(e)';...
    'EX_trp_L(e)';'EX_orn(e)';'EX_arg_L(e)';'EX_thr_L(e)';'EX_fol(e)';'EX_gln_L(e)';'EX_4pyrdx(e)';...
    'EX_ser_L(e)';'EX_glc(e)';'EX_ribflv(e)';'EX_glu_L(e)';'EX_tyr_L(e)';'EX_phe_L(e)';'EX_inost(e)';...
    'EX_Lcystin(e)';'EX_leu_L(e)';'EX_met_L(e)';'EX_cys_L(e)';'EX_asn_L(e)';'EX_mal_L(e)';'EX_ile_L(e)';...
    'EX_pyr(e)';'EX_lys_L(e)';'EX_ala_L(e)';'EX_cit(e)';'EX_pro_L(e)';'EX_gly(e)';'EX_asp_L(e)';'EX_34hpp';...
    'EX_octa(e)';'EX_4mop(e)';'EX_glyb(e)';'EX_val_L(e)';'EX_ade(e)';'EX_hxan(e)';'EX_gua(e)';'EX_ins(e)';...
    'EX_orot(e)';'EX_ura(e)';'EX_ahcys(e)';'EX_cbasp(e)';'EX_Lcystin(e)';'EX_ser_L(e)';'EX_cys_L(e)';...
    'EX_thm(e)';'EX_arg_L(e)';'EX_ncam(e)'};

theo_mass = [298.0974;243.0617;104.1075;123.0558;129.0552;117.0188;220.1185;128.0348;265.1123;138.0555;...
    132.0661;89.0239;115.0395;156.0773;205.0977;133.0977;175.1195;120.0661;440.1319;147.077;182.0453;...
    106.0504;179.0556;377.1461;148.061;182.0817;166.0868;179.0556;241.0317;132.1025;150.0589;122.0276;...
    133.0613;133.0137;132.1025;87.0082;147.1134;90.0555;191.0192;116.0712;74.0242;134.0453;180.157;...
    172.265;130.142;118.0868;118.0868;136.0623;137.0463;152.0572;267.0729;155.0093;111.0195;385.1294;...
    175.0355;241.0317;106.0504;122.0276;265.1123;175.1195;123.0558];

lod_ngmL = [0.3;1.7;2.8;3;3.5;3.9;4;4.8;6.1;7.7;8.1;10.9;11.2;13.6;15.7;16.9;24.8;25.6;25.7;28.4;32.7;...
    37.5;44;45;45;47.4;48.4;59;59.7;68.9;74.1;77;82.1;99.2;112.9;121.3;131.7;133.5;150.8;169.2;214.3;...
    229.5;537.3;10.9;3.5;2.8;28.2;1.6;0.8;48.9;8.8;37.1;52.4;50;229.5;59.7;37.5;77;6.1;24.8;3];

[lod_mM] = calculateLODs(theo_mass, lod_ngmL);
%% Step *3:* define the uptake and secretion profiles
% Exclude metabolites with uncertain experimental data from the list of metabolites 
% for which uptake and secretion profiles need to be computed

exclude_upt = {'EX_gln_L(e)'; 'EX_cys_L(e)'; 'EX_ala_L(e)'; 'EX_mal_L(e)'; 'EX_fol(e)'};
exclude_secr = {'EX_gln_L(e)'; 'EX_cys_L(e)'; 'EX_ala_L(e)'};
%% 
% Define metabolites with missing experimental points but for which uptake 
% and secretion profiles need to be computed

add_secr = {'EX_mal_L(e)'};
add_upt = {};
%% 
% The essential amino acids should be excluded from the secretion profile

essAA_excl = {'EX_his_L(e)'; 'EX_ile_L(e)'; 'EX_leu_L(e)'; 'EX_lys_L(e)'; 'EX_met_L(e)';...
    'EX_phe_L(e)'; 'EX_thr_L(e)'; 'EX_trp_L(e)'; 'EX_val_L(e)'};
%% 
% Define the list of metabolites for which experimental data are available

data_RXNS = {'EX_orn(e)';'EX_mal_L(e)';'EX_lac_L(e)';'EX_gly(e)';'EX_glu_L(e)';'EX_cit(e)';...
    'EX_5oxpro(e)';'EX_4mop(e)';'EX_3mop(e)';'EX_3mob(e)';'EX_tyr_L(e)';'EX_trp_L(e)';...
    'EX_thr_L(e)';'EX_pyr(e)';'EX_phe_L(e)';'EX_lys_L(e)';'EX_leu_L(e)';'EX_ile_L(e)';...
    'EX_glc(e)';'EX_chol(e)';'EX_anth(e)';'EX_val_L(e)';'EX_met_L(e)';'EX_his_L(e)';...
    'EX_gln_L(e)';'EX_cys_L(e)';'EX_ala_L(e)';'EX_pi(e)';'EX_asp_L(e)';'EX_4HPRO(e)';...
    'EX_pnto_R(e)';'EX_pro_L(e)';'EX_fol(e)'};
%% 
% Define the data associated with Molt-4 cell cultures

input_A = [
    % control TP 1	control TP 2	Cond TP 1	Cond TP 2
    65245.09667	68680.93	54272.41667	65159.50333
    3000	30970.784	20292.406	27226.6555
    2038946.433	1917042.967	5654513.467	101768253
    163882.9467	186682.92	121762.3567	310547.7
    473539.8667	455197.4667	462903.8333	1024508.5
    8681.527333	8704.7345	9459.837	34177.945
    29168.15	21808.73	120655.9867	2060525.467
    3000	3000	34436.50433	113668.5123
    3000	3000	25108.829	121927.3673
    3000	3000	3000	14717.55667
    4142302	4063607.667	3934639.333	3075783.333
    2153692	2132723.667	2037735.333	1387754.333
    406102.2667	417512.6333	381085.2333	259555.2667
    465074.6	387569.1333	439148.0667	210407.8333
    8087955	8345511.333	8215168.333	5360276
    198435.8	195675.8	188473.1	112386.1667
    20823770.33	20801258.67	19725086.67	15148808
    21229254.67	21225778.33	20799761	17160163
    76555640.67	71459886.33	61697085.33	34981419.33
    876300.4333	905132.5	892182.2	541860.4667
    159124.46	178538.2167	162567.13	3000
    2857012.667	2900419.667	2853523.667	1793173.667
    2995910.333	3018536.333	3024630.333	2266832.333
    69077.16333	67843.12	69406.69	95624.28
    3000	3000	824549.3667	2283200.867
    45304.84667	52977.77333	56566.27667	60759.23
    1613345.1	1258710.1	3430342.067	25970024.1
    216828142.3	221118425	223518663	216863897.3
    632160.0333	612562.3	590881.7333	940705.6
    814465.8333	786011.5667	630513.4	622493.9
    84638.70667	86751.96	89717.10667	68882.68333
    5107317.333	5168599.333	5163708.333	5263614.333
    95419.73667	105904.7067	97550.78667	102678.49
];
%% 
% Define the data associated with CCRF-CEM cell cultures

input_B = [
    % control 2 TP 1	control 2 TP 2	Cond 2 TP 1	Cond 2 TP 2
    65245.09667	68680.93	73850.77	98489.89
    3000	30970.784	3000	94181.77233
    2038946.433	1917042.967	5222377.933	134980059.9
    163882.9467	186682.92	219683.7	460476.5267
    473539.8667	455197.4667	437398.3667	630407.2667
    8681.527333	8704.7345	8317.144	86546.77933
    29168.15	21808.73	62146.47333	1012932.38
    3000	3000	9918.992	129433.4973
    3000	3000	7222.259333	145547.7347
    3000	3000	3000	17641.55667
    4142302	4063607.667	4023284.333	3489981.333
    2153692	2132723.667	2068977	1570648
    406102.2667	417512.6333	386495.2	303808.2
    465074.6	387569.1333	376779.1	249036.3333
    8087955	8345511.333	8237784.667	6540301.667
    198435.8	195675.8	196447.1	149861.6667
    20823770.33	20801258.67	21119935.67	16346765.67
    21229254.67	21225778.33	20790535.33	17219085
    76555640.67	71459886.33	65009057.67	24330565.33
    876300.4333	905132.5	884112.5667	259273.9333
    159124.46	178538.2167	158271.14	60631.19333
    2857012.667	2900419.667	2668140	2790196.333
    2995910.333	3018536.333	2890029.333	2538211
    69077.16333	67843.12	74035.24	86165.55
    3000	3000	323185.6667	2063962.067
    45304.84667	52977.77333	62076.23333	64524.22333
    1613345.1	1258710.1	2788313.567	30868376.53
    216828142.3	221118425	212276379	208623151.3
    632160.0333	612562.3	680373.4333	770903.9333
    814465.8333	786011.5667	679862.7	582257.4667
    84638.70667	86751.96	88002.12	99449.36667
    5107317.333	5168599.333	5134219	4445918.333
    95419.73667	105904.7067	100629.24	84807.62333
];
%% 
% Use the function _defineUptakeSecretionProfiles_ to calculate the uptake 
% and secretion rate over the time of the culture for both condition (e.g. CCRF-CEM 
% and Molt- 4 cells)

tol = 0.05;
[cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion, slope_Ratio] = defineUptakeSecretionProfiles...
    (input_A, input_B, data_RXNS, tol, essAA_excl, exclude_upt, exclude_secr, add_secr, add_upt);
%% Step *4*: Calculate the difference between the uptake and secretion profiles from the two conditions
% Use _calculateQuantitativeDiffs _to calculate the sets of exchange reactions 
% with higher uptake and secretion in condition 1 than in condition 2.

[cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher, cond1_uptake_LODs,...
    cond2_uptake_LODs, cond1_secretion_LODs, cond2_secretion_LODs] = calculateQuantitativeDiffs(data_RXNS,...
    slope_Ratio, ex_RXNS, lod_mM, cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion);
%% 
% NOTE: Sometimes, you will need to remove some metabolites from the uptake 
% and secretion profiles, e.g. those for which you assume a different directionality 
% as in the data or if the metabolites is not detected at a specific sampling 
% time. Indeed, the inclusion of these extreme point could distort the results. 
% Example of consumption slope ratio associated to _EX_anth(e)_ is 1975% higher 
% in Molt-4 compared to CCRF-CEM cells. Therefore, these metabolites need to be 
% removed from the input for semi-quantitative adjustment unless such large differences 
% are justified and make sense biologically.

remove = {'EX_anth(e)'; 'EX_ile_L(e)'};
A = [];
for i = 1:length(cond2_upt_higher)
    if find(ismember(remove, cond2_upt_higher{i, 1})) > 0
        A = [A; i];
    end
end
cond2_upt_higher(A, :) = [];
%% Step *5*:  Enforce uptake and secretion rate using qualitative constraints
% Use the function _setQualitativeConstraints_ to enforce minimal uptake or 
% secretion based on individual detection limits (e.g., based on the uptake and 
% secretion profile of metabolites measured through mass-spectrometry). If these 
% values are not available, a very small value (e.g., 1.0E-06) can be used. Note 
% that this value has to be below the concentrations defined in the medium, otherwise 
% the model will be infeasible.
% 
% Definition of the qualitative constraints for Molt-4 cells

ambiguous_metabolites = {'EX_ala_L(e)'; 'EX_gln_L(e)'; 'EX_cys_L(e)'};

basisMedium = {'EX_o2(e)'; 'EX_strch1(e)'; 'EX_acetone(e)'; 'EX_glc(e)'; 'EX_his_L(e)'; 'EX_ca2(e)'; 'EX_cl(e)'; 'EX_co(e)';...
    'EX_fe2(e)'; 'EX_fe3(e)'; 'EX_k(e)'; 'EX_na1(e)'; 'EX_i(e)'; 'EX_sel(e)'; 'EX_co2(e)'; 'EX_h(e)'; 'EX_h2o(e)'; 'EX_hco3(e)';...
    'EX_nh4(e)'; 'EX_o2(e)'; 'EX_pi(e)'; 'EX_so4(e)'};

[model_A] = setQualitativeConstraints(modelMedium, cond1_uptake, cond1_uptake_LODs, cond1_secretion, cond1_secretion_LODs, ...
    cellConc, t, cellWeight, ambiguous_metabolites, basisMedium);
%% 
% Definition of the qualitative constraints for CCRF-CEM cells

ambiguous_metabolites = {'EX_ala_L(e)'; 'EX_gln_L(e)'; 'EX_pydxn(e)'; 'EX_cys_L(e)'};

basisMedium = {'EX_ca2(e)'; 'EX_cl(e)'; 'EX_co(e)'; 'EX_fe2(e)'; 'EX_fe3(e)'; 'EX_k(e)'; 'EX_na1(e)'; 'EX_i(e)'; 'EX_sel(e)';...
    'EX_co2(e)'; 'EX_h(e)'; 'EX_h2o(e)'; 'EX_hco3(e)'; 'EX_nh4(e)'; 'EX_o2(e)'; 'EX_pi(e)'; 'EX_so4(e)'; 'EX_his_L(e)';...
    'EX_o2(e)'; 'EX_strch1(e)'; 'EX_acetone(e)'; 'EX_glc(e)'; 'EX_val_L(e)'; 'EX_met_L(e)'};

[model_B] = setQualitativeConstraints(modelMedium, cond2_uptake, cond2_uptake_LODs, cond2_secretion, cond2_secretion_LODs, ...
    cellConc, t, cellWeight, ambiguous_metabolites, basisMedium);
%% Step 6: Define semi quantitative constraints
% Use the relative difference of signal intensities previously calculated for 
% the two conditions (_calculateQuantitativeDiffs_) to define semi-quantitative 
% constraints (setSemiQuantConstraints).

[modelA_QUANT, modelB_QUANT] = setSemiQuantConstraints(model_A, model_B, cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher);
%% Step 7: Define growth constraints
% Using the data related to the doubling time for each cell, constrain the growth 
% reaction using _setConstraintsOnBiomassReaction_

GrowthRxn = 'biomass_reaction2';
tolerance = 20;
doublingTimeA = 19.6; %MOLT4 cells
[model_A_BM] = setConstraintsOnBiomassReaction(modelA_QUANT, GrowthRxn, doublingTimeA, tolerance);
doublingTimeB = 22; %CCRF-CEM
[model_B_BM] = setConstraintsOnBiomassReaction(modelB_QUANT, GrowthRxn, doublingTimeB, tolerance);
%% Step 8: Delete absent genes
% Constrain to zero the set of absent genes, defined in _DataGenes_

dataGenes = [535;1548;2591;3037;4248;4709;6522;7167;7367;8399;23545;129807;221823]; % set of genes absent in MOLT4 cells
[model_A_GE] = integrateGeneExpressionData(model_A_BM, dataGenes);

dataGenes = [239;443;535;1548;2683;3037;4248;4709;5232;6522;7364;7367;8399;23545;54363;66002;129807;221823];% set of genes absent in CCRF-CEM cells
[model_B_GE] = integrateGeneExpressionData(model_B_BM, dataGenes);
%% Step 9: Extract a condition specific FVA
% Use extractConditionSpecificModel to prune the model based on a user-defined 
% flux value threshold. This function a flux variability analyis to extract a 
% subnetwork for which all reactions carry fluxes higher or equal to the defined 
% threshold value

theshold = 1e-6;
model = model_A_GE;
[model_Molt] = extractConditionSpecificModel(model, theshold);%  MOLT4 condition specific model
[model_CEM] = extractConditionSpecificModel(model_B_GE, theshold);%  CCRF-CEM condition specific model
%% 
% *ANTICIPATED RESULTS*
% 
% Compare the differents model generated previously by analysing the metabolite 
% connectivity of the networks

[MetConn, RxnLength] = networkTopology(modelMedium); % model constrained by medium composition data
[MetConnA, RxnLengthA] = networkTopology(model_Molt); %  MOLT4 condition specific model
[MetConnB, RxnLengthB] = networkTopology(model_CEM); %  CCRF-CEM condition specific model
MetConnCompare = sort(MetConn, 'descend');
MetConnCompareA = sort(MetConnA, 'descend');
MetConnCompareB = sort(MetConnB, 'descend');
%% 
% Plot metabolite connectivity

figure
semilogy(sort(MetConnCompare, 'descend'), 'ro')
hold
semilogy(sort(MetConnCompareA, 'descend'), 'bo')
semilogy(sort(MetConnCompareB, 'descend'), 'go')
title('Metabolite connectivity')
%% 
% The models can also be compared by performing a sampling analysis using 
% _performSampling_

fprintf('Perform sampling analysis\n');
warmupn = 2000;
nFiles = 10;
pointsPerFile = 1000;
stepsPerPoint = 500;
fileBaseNo = 0;
maxTime = 3600000;

fileName = 'modelA';%  MOLT4 condition specific model
performSampling(model_Molt, warmupn, fileName, nFiles, pointsPerFile, stepsPerPoint, fileBaseNo, maxTime, outputPath);
fileName = 'modelB';%  CCRF-CEM condition specific model
performSampling(model_CEM, warmupn, fileName, nFiles, pointsPerFile, stepsPerPoint, fileBaseNo, maxTime, outputPath);
%% 
% Use the function _summarizeSamplingResults_ to return the median of the 
% flux values from the two sampled models. The analysis can be limited to a specific 
% set of reaction defined in _show_rxns_. Moreover, reactions associated with 
% genes of special interest ( e.g. differentially expressed genes) can be defined 
% in _dataGenes_ to facilitate the analysis

fonts = 8;
nFiles = 10;
pointsPerFile = 1000;
starting_Model = modelMedium;
hist_per_page = 4;
bin = 30;
modelA = model_Molt;
modelB = model_CEM;
dataGenes = [32;205;411;412;1537;1608;1632;1645;1737;1757;2108;2184;2224;2539];
show_rxns = {'PYK';'SUCD1m';'ATPS4m';'ETF'};
[stats, statsR] = summarizeSamplingResults(modelA, modelB, outputPath, nFiles, pointsPerFile, starting_Model, dataGenes, show_rxns, fonts, hist_per_page, bin, 'modelA', 'modelB');
##### SOURCE END #####
--></body></html>